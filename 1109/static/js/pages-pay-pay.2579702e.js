(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-pay-pay"],{"1e71":function(e,t,a){"use strict";a.r(t);var n=a("5138"),r=a("d826");for(var i in r)"default"!==i&&function(e){a.d(t,e,(function(){return r[e]}))}(i);a("6aec");var s,o=a("f0c5"),c=Object(o["a"])(r["default"],n["b"],n["c"],!1,null,"020bb874",null,!1,n["a"],s);t["default"]=c.exports},5138:function(e,t,a){"use strict";var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"payment"},[a("v-uni-view",{staticClass:"flex s-rows s-flex-center s-padding-top"},[a("v-uni-text",{staticClass:"s-text s-red"},[e._v("₫")]),a("v-uni-text",{staticClass:"pay_amount s-center s-red s-bold"},[e._v(e._s(e._f("toAmount")(e.payment.pay_amount)))])],1),a("v-uni-view",{staticClass:"flex s-rows s-flex-center"},[a("v-uni-text",{staticClass:"s-desc s-black6 s-center"},[e._v(e._s(e.i18n.k_zhi_fu_jin_e))])],1),a("v-uni-view",{staticClass:"flex s-flex-vtop "},[a("v-uni-text",{staticClass:"s-desc s-black6 s-margin"},[e._v(e._s(e.i18n.k_xuan_ze_zhi_fu_tong_dao))]),a("v-uni-view",{staticClass:"payment-list"},[a("v-uni-radio-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.radioChange.apply(void 0,arguments)}}},e._l(e.pay_type_list,(function(t,n){return a("v-uni-view",{key:n,staticClass:"payment-item flex s-space-between",staticStyle:{width:"100%",float:"left",height:"2rem"}},[a("v-uni-view",{staticClass:"flex s-nowrap s-flex-vcenter"},[a("v-uni-image",{staticClass:"pay-image",attrs:{src:t.image}}),a("v-uni-text",{staticClass:"s-text s-black6"},[e._v(e._s(t.text))])],1),a("v-uni-view",{staticClass:"flex s-flex-vbottom"},[a("v-uni-radio",{attrs:{value:t,color:e.baseColor,checked:n===e.current}})],1)],1)})),1)],1)],1),a("v-uni-view",{staticClass:"border-top-cell"}),a("v-uni-view",{staticClass:"flex s-margin-top"},[a("v-uni-text",{staticClass:"btns",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.doPay()}}},[e._v(e._s(e.i18n.k_que_ren_zhi_fu))])],1)],1)},i=[];a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n}))},"5c3a":function(e,t,a){"use strict";(function(e){var n=a("ee27");a("99af"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var r=n(a("c964")),i={data:function(){return{payment:{id:"",pay_amount:"0.00"},mealId:"",orderId:"",pay_type_list:[],current:"",baseColor:"",payType:"",prePayTime:0,timer:null}},onLoad:function(t){this.baseColor=this.$store.state.baseColor,e.log("onload:",t),this.mealId=t.id,this.getPayList()},onUnload:function(){clearInterval(this.timer)},computed:{i18n:function(){return this.$t("index")}},methods:{radioChange:function(e){this.payType=e.detail.value.type},doPay:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.payType){t.next=2;break}return t.abrupt("return");case 2:return(new Date).getTime(),e.prePayTime,t.next=6,e.createOrder();case 6:if(a=t.sent,e.orderId=a.data.id,!isNaN(e.orderId)){t.next=10;break}return t.abrupt("return",alert("Failed to create order! error code:1007"));case 10:return t.next=12,getApp().post("/meal/payOrder",{id:e.orderId,payType:e.payType,token:getApp().token});case 12:if(n=t.sent,200!=n.code){t.next=18;break}alert(n.data.info),"1001"==n.data.code&&(r=escape(n.data.data.payUrl),uni.navigateTo({url:"/pages/pay/payPage?payUrl=".concat(r,"&orderId=").concat(e.orderId)})),t.next=19;break;case 18:return t.abrupt("return",alert("Failed to create order! error code:1009"));case 19:case"end":return t.stop()}}),t)})))()},createOrder:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,getApp().post("/meal/buyMeal",{id:e.mealId,token:getApp().token},!0);case 2:return a=t.sent,200!=a.code&&uni.showToast({title:a.msg||i18n.k_chuang_jian_ding_dan_shi_bai,icon:"none"}),t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))()},getPayList:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,getApp().post("/meal/getPayTypeList?id="+e.mealId,{token:getApp().token});case 2:a=t.sent,200==a.code&&(e.payment={id:a.data.id,pay_amount:a.data.pay_amount},e.pay_type_list=a.data.pay_type_list);case 4:case"end":return t.stop()}}),t)})))()},payState:function(t,a){return(0,r.default)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,getApp().get("/meal/payState",{id:t,token:getApp().token});case 2:r=n.sent,200!=r.code&&(clearInterval(a),uni.showModal({title:i18n.k_zhi_fu_cheng_gong,content:"",showCancel:!1,success:function(t){t.confirm&&(clearInterval(a),e.log(a),e.log(i18n.k_yong_hu_dian_ji_que_ding))}}),setTimeout((function(e){uni.navigateBack({delta:1})}),1500));case 4:case"end":return n.stop()}}),n)})))()}}};t.default=i}).call(this,a("5a52")["default"])},"63e2":function(e,t,a){var n=a("fac3");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=a("4f06").default;r("364f344c",n,!0,{sourceMap:!1,shadowMode:!1})},"6aec":function(e,t,a){"use strict";var n=a("63e2"),r=a.n(n);r.a},d826:function(e,t,a){"use strict";a.r(t);var n=a("5c3a"),r=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=r.a},fac3:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.payment[data-v-020bb874]{background-color:#fff;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-flex:1;-webkit-flex:1;flex:1}.pay_amount[data-v-020bb874]{font-size:%?36?%}.payment-list[data-v-020bb874]{width:%?710?%;margin:%?20?%}.payment-item[data-v-020bb874]{margin-bottom:%?20?%}.pay-image[data-v-020bb874]{width:%?34?%;height:%?34?%;margin-right:%?10?%}.border-top-cell[data-v-020bb874]{width:%?750?%;height:%?10?%;background-color:#f2f2f2}.btns[data-v-020bb874]{width:%?710?%;margin:%?20?%;background-color:#7eb5fa;color:#fff;border-radius:%?10?%;text-align:center;font-size:%?30?%;padding-top:%?20?%;padding-bottom:%?20?%}.payment-item[data-v-020bb874]{width:100%}',""]),e.exports=t}}]);